### Εγκατάσταση

Aπαιτείται Apache web server με υποστήριξη PHP 5. Η εφαρμογή έχει
δοκιμασθεί σε περιβάλλον σχολικού δικτύου και είναι απλή στην
εγκατάστασή της καθώς δεν απαιτεί τη ρύθμιση κάποιας βάσης δεδομένων.

Για την εγκατάσταση δεν χρειάζεται να είναι κάποιος προγραμματιστής,
όμως καλό θα ήταν να είναι κάποιος έμπειρος χρήστης των υπολογιστών και
του διαδικτύου και να έχει FTP\* πρόσβαση στο website της υπηρεσίας του.
Αν δεν έχετε τις γνώσεις ή τα δικαιώματα απευθυνθείτε στο διαχειριστή
του website της υπηρεσίας σας.

1.  Επιλέξτε Download zip (στο κάτω μέρος της δεξιάς στήλης) για να κατεβάσετε το αρχείο και
    αποσυμπιέστε το στο δίσκο σας.
2.  Στη συνέχεια μετονομάστε το φάκελο που προέκυψε (π.χ. σε misthodosia) και ανεβάστε τον
    με FTP στο root (public_html) του site σας.
3.  Με το FTP πρόγραμμα μπείτε στον υποφάκελο **XMLData** και ορίστε τα
    δικαιώματα του φακέλου σε **770** (Με αυτή τη ρύθμιση, κανείς άλλος
    εκτός από το πρόγραμμα δεν έχει πρόσβαση στα XML αρχεία που θα
    ανεβάζετε). Βεβαιωθείτε επίσης ότι τα δικαιώματα για το φάκελο **userData** είναι σε
    **755**
4.  Ανοίξτε το αρχείο config.inc.sample.php με κάποιον text-editor\* (π.χ.
    notepad) και κάντε τις ακόλουθες ρυθμίσεις…

    - Αλλάξτε την παράμετρο
    ORG_TITLE από ‘<span style="text-decoration: underline;">*Όνομα
    υπηρεσίας*</span>‘ στο όνομα της δικής σας υπηρεσίας.

    - Αλλάξτε την παράμετρο ORG_URL από
    ‘<span style="text-decoration: underline;">*http://url-tou-site-sas*</span>‘
    στο url του δικού σας ιστότοπου.

    - Ορίστε όνομα διαχειριστή και κωδικό στις παραμέτρους SUPER_USER και SUPER_PASS
    για να μπορείτε να διαχειριστείτε την εφαρμογή χωρίς τη χρήση FTP

5.  Τέλος, **αποθηκεύστε το αρχείο ως config.inc.php** και ανεβάστε το στο server. Αν ερωτηθείτε,
    επιλέξτε overwrite (αντικατάσταση του υπάρχοντος).

\* Ενδεικτικά… Για FTP πρόγραμμα πρόγραμμα προτείνω το [filezilla](http://filezilla-project.org/) και
για text-editor πάρα πολύ καλά είναι τα [notepad++](http://notepad-plus-plus.org/) και [sublime text
2](http://www.sublimetext.com/2)

### Χρήση της εφαρμογής

Κάθε μισθοδοτούμενος μπορεί να επισκέπτεται τη διεύθυνση
http://url-tou-site-sas/misthodosia-online/ και να εισάγει τον ΑΦΜ και
τον ΑΜ του για να βλέπει αναλυτικά τη μισθοδοσία του ανά περίοδο.

Από την έκδοση 1.5 και μετά η χρήση της εφαρμογής έχει απλοποιηθεί, καθώς υπάρχει πλέον
περιβάλλον διαχείρισης και δεν χρειάζεται η χρήση FTP.

Πλέον, αν επισκεφθείται το url της εφαρμογής, θα δείτε πάνω δεξιά το link "Διαχείριση".
Πατώντας το θα σας ζητηθεί να δώσετε όνομα διαχειριστή και κωδικό. Αφού το κάνετε θα δείτε
πλέον το περιβάλλον διαχείρισης που αποτελείται από 3 τμήματα.

- Στο "Μισθοδοτούμενοι", υπάρχει αλφαβητική λίστα με όλους τους μισθοδοτούμενους για τους οποίους
έχουν αποθηκευτεί στοιχεία από την ανάλυση των XML. Επίσης, βάζοντας μερικούς χαρακτήρες στο πλαίσιο
"Γρήγορη αναζήτηση" μπορείτε να εντοπίσετε εύκολα και γρήγορα τον μισθοδοτούμενο που θέλετε. Κάνοντας
κλικ πάνω του, βλέπετε την εικόνα του χωρίς να χρειαστεί να δώσετε το ΑΦΜ και τον ΑΜ του.

- Στο "Διαχείριση XML" βλέπετε όλα τα αρχεία XML που έχουν ανέβει μεχρι τώρα. Η ταξινόμηση είναι
με βάση την περίοδο πληρωμής ενώ φαίνονται ακόμα το όνομα του αρχείου καθώς και το πότε ανέβηκε.
Μέσω της φόρμας μπορείτε να επιλέξετε και να ανεβάσετε ένα νέο XML ή να σβήσετε κάποιο από τα υπάρχοντα.
Σε αυτή την περίπτωση, θα πρέπει να τρέξετε ξανά την "Ανάλυση αρχείων" για να ενημερωθούν τα στοιχεία των
μισθοδοτούμενων. Το πρόγραμμα σας ειδοποιεί αυτόματα όταν αυτό είναι απαραίτητο.

- Στο "Αρχείο καταγραφής" μπορείτε να βλέπετε ενέργειες που έκαναν οι χρήστες σας αλλά και εσείς.
Για παράδειγμα πότε και ποιός είδε την εικόνα του, αν κάποιος απέτυχε να κάνει login κ.τ.λ.

- ***ΝΕΟ*** (από την έκδοση 2.0.0 και μετά) Στη σελίδα "Ρυθμίσεις" θα βρείτε 3 καρτέλες.

    - Στην καρτέλα "Κείμενα" μπορείτε να αλλάξετε τα κείμενα που εμφανίζονται στην αρχική σελίδα μέσα από ένα εύχρηστο wysiwyg επεξεργαστή κειμένου. Απλά κάντε τις αλλαγές που θέλετε και πιέστε αποθήκευση στο κάτω μέρος της σελίδας

    - Στην καρτέλα "Κωδικοί" μπορείτε να προσθέσετε κωδικούς για τους μισθοδοτούμενους που θέλουν να προστατέψουν τα δεδομένα τους ώστε να μην μπορεί να έχει πρόσβαση κάποιος με τον Α.Μ. αλλά με τον κωδικό που θα ορίσετε. Διαβάστε τις οδηγίες που υπάρχουν στη σελίδα για περισσότερες λεπτομέρειες.

    - Τέλος, στην καρτέλα "Google Analytics" μπορείτε να προσθέσετε τον αντίστοιχο κώδικα για να παρακολουθείτε τα στατιστικά του site σας.

ΠΡΟΣΟΧΗ: Θα πρέπει να προσέξετε ώστε να μην ανέβουν αντίγραφα αρχείων,
με τα ίδια δηλαδή δεδομένα αλλά με διαφορετικά ονόματα (για παράδειγμα
δοκιμαστικά XML που χρησιμοποιήσατε για έλεγχο). Κάτι τέτοιο θα έχει ως
αποτέλεσμα οι αποδοχές των εργαζομένων να εμφανίζονται διπλάσιες από τις
πραγματικές. Ανεβάζετε λοιπόν μόνο τα αρχεία .xml που έχουν σταλεί και
στην ΕΑΠ.

### Αναβάθμιση

Κατεβάζετε την τελευταία έκδοση της εφαρμογής από το github, την αποσυμπιέζετε
και ανεβάζετε ξανά τα αρχεία με ftp στο διακομιστή σας, κάνοντας overwrite.

Mετά την αναβάθμιση είναι απαραίτητο να ξανατρέξετε την "Ανάλυση αρχείων".

**ΠΡΟΣΟΧΗ!** Μόνο όσοι αναβαθμίζεστε στην έκδοση 1.5 ή μεγαλύτερη **από παλαιότερη έκδοση (πριν την 1.5)*** θα πρέπει οπωσδήποτε να δημιουργήσετε
ξανά το config.inc.php τροποποιώντας το config.sample.inc.php (δείτε περισσότερες λεπτομέρειες στο
βήμα 4 του τμήματος που αφορά στην εγκατάσταση).

### Αντιμετώπιση προβλημάτων (π.χ. proxy error)

Μερικές φορές, η ανάλυση των αρχείων μπορεί να εμφανίσει "proxy error" αντί για το μήνυμα ότι αναλύθηκαν όλα τα αρχεία. Αυτό παρατηρείται
μόνο στο σέρβερ του σχολικού δικτύου και δε σημαίνει απαραίτητα ότι η ανάλυση των αρχείων δεν ολοκληρώθηκε. Για να εξακριβώσετε αν τελικά
αναλύθηκαν τα αρχεία, αρκεί να δείτε ότι έχει ενημερωθεί η εικόνα ενός οποιουδήποτε μισθοδοτούμενου με τη νέα περίοδο που μόλις ανεβάσατε.

Αν μετά από αρκετές προσπάθειες, οι εικόνες των μισθοδοτούμενων παραμένουν ανενημέρωτες ειδικά αν εμφανιστεί σφάλμα ότι εξαντλήθηκε η μνήμη του συστήματος τότε θα πρέπει να σβήσετε μερικά παλαιότερα αρχεία XML και να δοκιμάσετε να ξανατρέξετε την ανάλυση των αρχείων (από τη διαχείριση XML.
Για παράδειγμα σε διεύθυνση με 900 μισθοδοτούμενους, τα προβλήματα άρχισαν να εμφανίζονται όταν υπήρχαν αρχεία XML που κάλυπταν πάνω από ένα χρόνο.

**UPDATE**. Από την έκδοση 2.0.0 και μετά, είναι δυνατή η ανάλυση περισσότερων αλλά και μεγαλύτερων αρχείων. Τα παραπάνω σφάλματα θα πρέπει πλέον
να συμβαίνουν πολύ πιο σπάνια.

### Παραμετροποίηση

Η παραμετροποίηση γίνεται κάνοντας αλλαγές στο αρχείο **config.inc.php**
στο οποίο υπάρχουν αναλυτικά σχόλια για το τι κάνει κάθε ρύθμιση.
Ενδεικτικά μπορείτε να ρυθμίσετε…

- Τα ονόματα των φακέλων όπου αποθηκεύονται τα δεδομένα και οι
βιβλιοθήκες

- Την ονομασία και τη url διεύθυνση της υπηρεσίας σας

- Όνομα χρήστη και κωδικό για το λογαριασμό του διαχειριστή.

- Το μήκος του Αριθμού Μητρώου των εργαζομένων σας. Από πόσους δηλαδή
αριθμούς/χαρακτήρες αποτελείται ο ΑΜ των εργαζομένων της υπηρεσίας σας.
Αν το ορίσετε σωστά, τότε θα απαιτείται και ο ΑΜ εκτός από τον ΑΦΜ για
να δει κάποιος τη μισθοδοσία του.

Ένα ακόμα αρχείο που ίσως χρειαστεί να πειράξετε είναι το
**eapCodes.php** όπου γίνεται αντιστοίχηση των κωδικών (κρατήσεων ή
επιδομάτων) που υπάρχουν στα XML αρχεία με περιγραφές, ώστε να είναι
κατανοητοί στους μισθοδοτούμενους. Σε περίπτωση που κάποιος κωδικός δεν
έχει αντιστοίχηση σε περιγραφή θα συμπεριληφθεί στην ανάλυση αλλά θα
εμφανιστεί απλά ως κωδικός (χωςρίς περιγραφή).

#### Ενεργοποίηση της εξαγωγής σε PDF

Αν θέλετε να υπάρχει η δυνατότητα εξαγωγής των μισθοδοσιών σε pdf, τότε
θα πρέπει…

- Να κατεβάσετε τη βιβλιοθήκη tcpdf από εδώ: http://www.tcpdf.org/

- Να αποσυμπιέσετε και να ανεβάσετε το φάκελο tcpdf (μετονομάστε τον αν
δεν έχει ήδη αυτό το όνομα), μέσα στο φάκελο misthodosia-online

Προαιρετικά μπορείτε να αλλάξετε το όνομα του φακέλου που υπάρχει η
βιβλιοθήκη στο αρχείο config.inc.php